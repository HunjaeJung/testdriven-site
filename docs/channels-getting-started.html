<!DOCTYPE html>
<html>

  <head>
  <!-- meta -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <link rel="shortcut icon" type="image/png" href="/favicon.png">
  <!-- og -->
  
  <!-- description -->
  
  <!-- keywords -->
  
  <!-- title -->
  
    <title>Microservices with Docker, Flask, and React - Getting Started</title>
    <meta property="og:title" content="Microservices with Docker, Flask, and React - Getting Started" />
  
  <!-- styles -->
  <link rel="stylesheet" href="/assets/vendor/bootstrap.min.css">
  <link href="//use.fontawesome.com/releases/v5.0.6/css/all.css" rel="stylesheet">
  <link href="//cdn-images.mailchimp.com/embedcode/classic-10_7.css" rel="stylesheet" type="text/css">
  <link href="/assets/css/styles.css?1520824363462268000" rel="stylesheet">
</head>


  <body>

    <nav class="navbar navbar-expand-md navbar-dark bg-dark fixed-top">
  <div class="container">
    <a class="navbar-brand" href="/">
      <img
        class="nav-logo" src="/assets/img/test_driven_io_full_logo_white_text.svg" alt="testdriven.io"
      />
    </a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarsExampleDefault" aria-controls="navbarsExampleDefault" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarsExampleDefault">
      <ul class="navbar-nav mr-auto">
        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
            Courses
          </a>
          <div class="dropdown-menu" aria-labelledby="navbarDropdown">
            <a class="dropdown-item" href="/microservices">Microservices with Docker, Flask, and React</a>
            <a class="dropdown-item" href="/channels">Django Channels and Angular</a>
            <div class="dropdown-divider"></div>
            <a class="dropdown-item" href="/testimonials">Testimonials</a>
            <a class="dropdown-item" href="/course-contents">Contents</a>
          </div>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="/blog">Blog</a>
        </li>
      </ul>
    </div>
    <ul class="navbar-nav flex-row ml-md-auto d-none d-md-flex">
      <li class="nav-item">
        <a class="nav-link" href="https://twitter.com/testdrivenio"><i class="fab fa-twitter"></i></a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="https://github.com/testdrivenio"><i class="fab fa-github"></i></a>
      </li>
      <li class="nav-item nav-purcahse-btn">
        <a class="btn btn-outline-warning" href="/">Purchase the Courses</a>
      </li>
  </ul>
  </div>
</nav>


    <div class="container">
      <div class="row">

        <div class="col-md-9">

          <h1>Getting Started</h1>

          

            <h5>Part 1, Lesson 2</h5>

            <div class="page-nav">
              <br>
              
                <a class="btn btn-outline-success" href="http://localhost:4000/channels-intro">&laquo; Introduction</a>
              
              
                <a class="btn btn-outline-success" href="http://localhost:4000/channels-auth">Authentication &raquo;</a>
              
            </div>

            
  
    <br>
    <a class="twitter-share-button" data-show-count="false" href="https://twitter.com/intent/tweet?text=Microservices with Docker, Flask, and React - Getting Started&amp;url=http%3A%2F%2Flocalhost%3A4000/channels-getting-started&amp;via=testdrivenio" rel="nofollow" target="_blank" title="Share on Twitter"></a><script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script>
  



            <br><br>

          

          <p>Start by creating a new project directory called “taxi-app” to hold both the client and server application.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">mkdir </span>taxi-app <span class="o">&amp;&amp;</span> <span class="nb">cd </span>taxi-app
</code></pre></div></div>

<p>Then, within “taxi-app”, create a new virtual environment to isolate our project’s dependencies:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">mkdir </span>django-taxi <span class="o">&amp;&amp;</span> <span class="nb">cd </span>django-taxi
<span class="nv">$ </span>python3.6 <span class="nt">-m</span> venv <span class="nb">env</span>
<span class="nv">$ </span><span class="nb">source env</span>/bin/activate
<span class="o">(</span><span class="nb">env</span><span class="o">)</span><span class="err">$</span>
</code></pre></div></div>

<p>Install <a href="https://www.djangoproject.com/">Django</a>, <a href="http://www.django-rest-framework.org/">Django REST Framework</a>, <a href="https://channels.readthedocs.io">Django Channels</a>, <a href="https://github.com/django/asgi_redis">ASGI Redis</a>, and <a href="https://python-pillow.org/">Pillow</a>, and then create a new Django project and app:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">(</span><span class="n">env</span><span class="p">)</span><span class="err">$</span> <span class="n">pip</span> <span class="n">install</span> \
        <span class="n">django</span><span class="o">==</span><span class="mf">2.0</span><span class="o">.</span><span class="mi">2</span> \
        <span class="n">djangorestframework</span><span class="o">==</span><span class="mf">3.7</span><span class="o">.</span><span class="mi">7</span> \
        <span class="n">channels</span><span class="o">==</span><span class="mf">1.1</span><span class="o">.</span><span class="mi">8</span> \
        <span class="n">asgi</span><span class="o">-</span><span class="n">redis</span><span class="o">==</span><span class="mf">1.4</span><span class="o">.</span><span class="mi">3</span> \
        <span class="n">Pillow</span><span class="o">==</span><span class="mf">5.0</span><span class="o">.</span><span class="mi">0</span>
<span class="p">(</span><span class="n">env</span><span class="p">)</span><span class="err">$</span> <span class="n">django</span><span class="o">-</span><span class="n">admin</span><span class="o">.</span><span class="n">py</span> <span class="n">startproject</span> <span class="n">example_taxi</span>
<span class="p">(</span><span class="n">env</span><span class="p">)</span><span class="err">$</span> <span class="n">cd</span> <span class="n">example_taxi</span>
<span class="p">(</span><span class="n">env</span><span class="p">)</span><span class="err">$</span> <span class="n">python</span> <span class="n">manage</span><span class="o">.</span><span class="n">py</span> <span class="n">startapp</span> <span class="n">example</span>
</code></pre></div></div>

<blockquote>
  <p>Review <a href="https://github.com/pypa/pip/issues/4205">SSL: CERTIFICATE_VERIFY_FAILED with Python 3.6.0</a> if you run into an <code class="highlighter-rouge">CERTIFICATE_VERIFY_FAILED</code> error when trying to install Pillow.</p>
</blockquote>

<p>Next, download and install <a href="https://redis.io/download">Redis</a>.</p>

<blockquote>
  <p>If you’re on a Mac, we recommend using Homebrew:</p>

  <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>brew <span class="nb">install </span>redis
</code></pre></div>  </div>
</blockquote>

<p><a href="https://redis.io/topics/quickstart#starting-redis">Start the Redis server</a> in a new terminal window and make sure that it is running on its default port, 6379. The port number will be important when we tell Django how to communicate with Redis.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>redis-server
</code></pre></div></div>

<p>Complete the setup by updating <code class="highlighter-rouge">INSTALLED_APPS</code> in the project’s <em>settings.py</em> file within your code editor of choice:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">INSTALLED_APPS</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s">'django.contrib.admin'</span><span class="p">,</span>
    <span class="s">'django.contrib.auth'</span><span class="p">,</span>
    <span class="s">'django.contrib.contenttypes'</span><span class="p">,</span>
    <span class="s">'django.contrib.sessions'</span><span class="p">,</span>
    <span class="s">'django.contrib.messages'</span><span class="p">,</span>
    <span class="s">'django.contrib.staticfiles'</span><span class="p">,</span>
    <span class="s">'channels'</span><span class="p">,</span>
    <span class="s">'rest_framework'</span><span class="p">,</span>
    <span class="s">'rest_framework.authtoken'</span><span class="p">,</span>
    <span class="s">'example'</span><span class="p">,</span>
<span class="p">]</span>

<span class="n">AUTH_USER_MODEL</span> <span class="o">=</span> <span class="s">'example.User'</span>
</code></pre></div></div>

<p>Here, alongside the boilerplate Django apps, we added Django Channels and Django REST Framework. We also added Django REST Framework’s <code class="highlighter-rouge">authtoken</code> app, so that we can use the <em>token authentication</em> backend. Lastly, we added our own <code class="highlighter-rouge">example</code> app.</p>

<p>We also added an <code class="highlighter-rouge">AUTH_USER_MODEL</code> setting to make Django reference a user model of our design instead of the built-in one since we’ll need to store more user data than what the standard fields allow.</p>

<blockquote>
  <p>Since we’re creating this project from scratch, defining a custom user model is the right move. If we had made this change later in the project, we would have had to create a supplementary model and link it to the existing default user model.</p>
</blockquote>

<p>Create a simple custom user model in the <em>example/models.py</em> file.</p>

<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">django.contrib.auth.models</span> <span class="kn">import</span> <span class="n">AbstractUser</span>


<span class="k">class</span> <span class="nc">User</span><span class="p">(</span><span class="n">AbstractUser</span><span class="p">):</span>
    <span class="k">pass</span>
</code></pre></div></div>

<p>Create a new migration:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">(</span><span class="nb">env</span><span class="o">)</span><span class="nv">$ </span>python manage.py makemigrations
</code></pre></div></div>

<p>Now we can run the Django management <code class="highlighter-rouge">migrate</code> command, which will properly set up our app to use our custom user model. All database tables, including Django REST Framework’s auth token table, will be created as well.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">(</span><span class="nb">env</span><span class="o">)</span><span class="nv">$ </span>python manage.py migrate
</code></pre></div></div>

<p>You should see something similar to:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Operations to perform:
  Apply all migrations: admin, auth, authtoken, contenttypes, example, sessions
Running migrations:
  Applying contenttypes.0001_initial... OK
  Applying contenttypes.0002_remove_content_type_name... OK
  Applying auth.0001_initial... OK
  Applying auth.0002_alter_permission_name_max_length... OK
  Applying auth.0003_alter_user_email_max_length... OK
  Applying auth.0004_alter_user_username_opts... OK
  Applying auth.0005_alter_user_last_login_null... OK
  Applying auth.0006_require_contenttypes_0002... OK
  Applying auth.0007_alter_validators_add_error_messages... OK
  Applying auth.0008_alter_user_username_max_length... OK
  Applying auth.0009_alter_user_last_name_max_length... OK
  Applying example.0001_initial... OK
  Applying admin.0001_initial... OK
  Applying admin.0002_logentry_remove_auto_add... OK
  Applying authtoken.0001_initial... OK
  Applying authtoken.0002_auto_20160226_1747... OK
  Applying sessions.0001_initial... OK
</code></pre></div></div>

<p>Ensure all is well by running the server:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">(</span><span class="nb">env</span><span class="o">)</span><span class="nv">$ </span>python manage.py runserver
</code></pre></div></div>

<p>Then, navigate to <a href="http://localhost:8000/">http://localhost:8000/</a> within your browser of choice. You should see:</p>

<p><img src="../../images/01_django_default_page.png" alt="django landing page" /></p>

<p>Kill the server. Next, configure the <code class="highlighter-rouge">CHANNEL_LAYERS</code> by setting a default Redis <a href="https://channels.readthedocs.io/en/1.x/backends.html#redis">backend</a> and routing in the <em>settings.py</em>:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">REDIS_URL</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s">'REDIS_URL'</span><span class="p">,</span> <span class="s">'redis://localhost:6379'</span><span class="p">)</span>

<span class="n">CHANNEL_LAYERS</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s">'default'</span><span class="p">:</span> <span class="p">{</span>
        <span class="s">'BACKEND'</span><span class="p">:</span> <span class="s">'asgi_redis.RedisChannelLayer'</span><span class="p">,</span>
        <span class="s">'CONFIG'</span><span class="p">:</span> <span class="p">{</span>
            <span class="s">'hosts'</span><span class="p">:</span> <span class="p">[</span><span class="n">REDIS_URL</span><span class="p">],</span>
        <span class="p">},</span>
        <span class="s">'ROUTING'</span><span class="p">:</span> <span class="s">'example_taxi.routing.channel_routing'</span><span class="p">,</span>
    <span class="p">},</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Try running the server again. You should see the following error:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ModuleNotFoundError: No module named <span class="s1">'example_taxi.routing'</span>
</code></pre></div></div>

<p>Add a new file called <em>routing.py</em> to “example_taxi”:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">channel_routing</span> <span class="o">=</span> <span class="p">[]</span>
</code></pre></div></div>

<p>Run with this for now. We’ll look at what’s happening here in an upcoming lesson.</p>

<hr />

<p>Before moving on, take a moment to review all that we’ve done thus far. Try to answer the “why” along with the “what” and “how”. For example, why did we use Redis over an in-memory layer for Django Channels?</p>


          

            
  
    <br>
    <a class="twitter-share-button" data-show-count="false" href="https://twitter.com/intent/tweet?text=Microservices with Docker, Flask, and React - Getting Started&amp;url=http%3A%2F%2Flocalhost%3A4000/channels-getting-started&amp;via=testdrivenio" rel="nofollow" target="_blank" title="Share on Twitter"></a><script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script>
  



            <div class="page-nav">
              <br>
              
                <a class="btn btn-outline-success" href="http://localhost:4000/channels-intro">&laquo; Introduction</a>
              
              
                <a class="btn btn-outline-success" href="http://localhost:4000/channels-auth">Authentication &raquo;</a>
              
            </div>

          

        </div>

        
  
    <div class="col-sm-3 d-none d-md-block">
    <div id="toc-block" class="collection">
      <span class="text-center"><h4>Course Preview:</h4></span>
      <ul class="collapsible collapsible-accordion">
        <br>
          <li>

            <!-- create header for part -->
            <h5 class="btn btn-outline-dark btn-block" data-toggle="collapse" href="#collapse1">
              Part 1
            </h5>

            <!-- create ul for hidden part content -->
            <ul data-part="1" class="collapse show" id="collapse1" style="padding:0">

              <!-- nested loop -->
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
                  <li>
                    <span class="badge">&bull;</span>
                    <span>
                      <a href="http://localhost:4000/channels-intro">
                        Introduction
                      </a>
                    </span>
                  </li>
                
              
                
                  <li>
                    <span class="badge">&bull;</span>
                    <span>
                      <a href="http://localhost:4000/channels-getting-started">
                        Getting Started
                      </a>
                    </span>
                  </li>
                
              
                
                  <li>
                    <span class="badge">&bull;</span>
                    <span>
                      <a href="http://localhost:4000/channels-auth">
                        Authentication
                      </a>
                    </span>
                  </li>
                
              
                
                  <li>
                    <span class="badge">&bull;</span>
                    <span>
                      <a href="http://localhost:4000/channels-http">
                        HTTP
                      </a>
                    </span>
                  </li>
                
              
                
                  <li>
                    <span class="badge">&bull;</span>
                    <span>
                      <a href="http://localhost:4000/channels-web-sockets">
                        WebSockets
                      </a>
                    </span>
                  </li>
                
              
                
                  <li>
                    <span class="badge">&bull;</span>
                    <span>
                      <a href="http://localhost:4000/channels-ui-support">
                        UI Support
                      </a>
                    </span>
                  </li>
                
              
                
                  <li>
                    <span class="badge">&bull;</span>
                    <span>
                      <a href="http://localhost:4000/channels-user-photos">
                        User Photos
                      </a>
                    </span>
                  </li>
                
              
                
                  <li>
                    <span class="badge">&bull;</span>
                    <span>
                      <a href="http://localhost:4000/channels-conclusion">
                        Conclusion
                      </a>
                    </span>
                  </li>
                
              
                
              
                
              
                
              
                
              

              <br>

            </ul>

        </li>
      </ul>
    </div>
  </div>

  



      </div>
    </div>

     <footer class="footer text-center">
  <div class="container">
    <hr>
    <small>
      <p>
      <span>&copy; Copyright 2018</span>
      <a href="http://testdriven.io">TestDriven.io</a>.
      <br>
      <span>Developed by </span>
      <a href="http://mherman.org/">Michael Herman</a>.
      <br>
      <span>Questions? </span>
      <a href="mailto:michael@mherman.org">michael@mherman.org</a>
      <p>
    </small>
  </div>
</footer>


    <script
  src="//code.jquery.com/jquery-2.2.4.min.js"
  integrity="sha256-BbhdlvQf/xTY9gja0Dq3HiwQF8LaCRTXxZKRutelT44="
  crossorigin="anonymous"
></script>
<script
  src="//maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
  crossorigin="anonymous"
></script>
<script
  type="text/javascript"
  src="/assets/js/main.js"
></script>
<script
  type="text/javascript"
  src="https://gumroad.com/js/gumroad.js"
></script>
<!-- addthis -->

  <script
    type="text/javascript"
    src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-50e5f1cc35ad077d"
  ></script>



    


  </body>
</html>
